---
title: "re_tidy"
author: "bea cheda"
date: "2025-02-17"
output: html_document
---

Load the data
```{r, message = FALSE, warning = FALSE}
groenigen_data <- readr::read_delim("../data/groenigen_data.csv", 
  delim = ";", escape_double = FALSE, trim_ws = TRUE, skip = 3)
```

Rename variables of interest
```{r}
base::names(groenigen_data)[names(groenigen_data)
  %in% c("Time (years)", "ambient CO2...6", "increased CO2...7")] <- c("years",      "ambient_CO2", "increased_CO2")

``` 

What is the range of the years variable?
```{r}
summary(groenigen_data$years)
```

Minimum is 0 and maximum is 11, so each observation can be categorized as
either early, mid or late phase.
Assign 1 if experiment has taken place in the early phase
Assign 2 if experiment has taken place in the mid phase
Assign 3 if experiment has taken place in the late phase
Use nested ifelse statements
```{r}
groenigen_data <- groenigen_data |>
  dplyr::mutate(phase = ifelse(groenigen_data$years < 3, "early",
                   ifelse(groenigen_data$years >= 3 
                   & groenigen_data$years <= 6, "mid",
                     "late")
                  )
                )
```


Calculate log-response ratio for each observation
```{r}
groenigen_data <- groenigen_data |> 
  dplyr::mutate(log_rr = log(increased_CO2 / ambient_CO2))
```

Calculate the means of the log-response ratios for each phase
```{r}
rr_means <- groenigen_data |> 
  dplyr::group_by(phase) |> 
  dplyr::summarise(rr_mean = mean(log_rr))
```

Visualize the phase means in a table
```{r}

knitr::kable(rr_means, caption = "Log-response mean per phase")

```
The data we are looking at represent mean measurements of grams of soil Carbon 
per square meter in different soils around the globe and with expositions to
different concentration levels of CO2 (a high and a low level) over time.

According to Groenigen et al., higher levels of CO2 concentration lead to
increased carbon inputs to the soil (+19.8%), but they also stimulate the turnover 
of soil C (+16.5%), implying that soils are maybe less of a carbon sink we count
on in the future than we initially thought. If a higher concentration induces
increases in both carbon input and carbon turnover, the measurements shouldn't
fluctuate too much over time. A slight increase is expected, since the inputs
increase somewhat more than the turnover.

Looking at the log-response ratio
RR = ln(carbon in soil under high CO2/carbon in soil under low CO2)
we can expect a slightly positive RR. Since the carbon concentration in the soil
is supposed to slightly increase from low to high CO2 atmospheric concentration,
we expect the ratio to be slightly above 1. The natural logarithm of numbers
slightly above 1 are positive and close to 0. If nothing changes, the ratio 
remains 1 and the natural logarithm equals 0, if the turnover is bigger than
the intake, the ratio will be below 1 and the RR will therefore be negative.

Our results for the early and mid phase are positive and slightly above 0 
(respectively 0.01 and 0.02) as we expected. The increase in carbon soil intake
due to higher atmospheric CO2 concentration is slightly bigger than the increase 
in soil carbon turnover.
The mean RR for the late phase (>6 years), on the other hand, is slightly
negative (-0.03), which would indicate that in the "long run", there is even
more turnover than intake when the atmospheric CO2 concentration is high.
